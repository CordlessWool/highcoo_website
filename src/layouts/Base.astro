---
interface Props {
    title: string;
    description?: string;
    ogImage?: string;
    article?: boolean;
    publishedTime?: string;
}

const {
    title,
    description = "Tag, watermark, and publish your photos. Self-hosted and open source.",
    ogImage,
    article = false,
    publishedTime,
} = Astro.props;

const canonicalURL = new URL(Astro.url.pathname, Astro.site);
const resolvedOgImage =
    ogImage ?? new URL("/og-default.png", Astro.site).toString();
const pageTitle = title === "Highcoo" ? "Highcoo" : `${title} | Highcoo`;
---

<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="description" content={description} />
        <link rel="canonical" href={canonicalURL} />

        <script
            defer
            src="https://umami.dropanote.de/script.js"
            data-website-id="96388b2c-594d-4967-bdd5-46644c0a41c3"></script>
        <!-- OpenGraph -->
        <meta property="og:site_name" content="Highcoo" />
        <meta property="og:title" content={pageTitle} />
        <meta property="og:description" content={description} />
        <meta property="og:url" content={canonicalURL} />
        <meta property="og:image" content={resolvedOgImage} />
        <meta property="og:image:width" content="1200" />
        <meta property="og:image:height" content="630" />
        {
            article ? (
                <meta property="og:type" content="article" />
            ) : (
                <meta property="og:type" content="website" />
            )
        }
        {
            publishedTime && (
                <meta
                    property="article:published_time"
                    content={publishedTime}
                />
            )
        }

        <!-- Twitter Card -->
        <meta name="twitter:card" content="summary_large_image" />
        <meta name="twitter:title" content={pageTitle} />
        <meta name="twitter:description" content={description} />
        <meta name="twitter:image" content={resolvedOgImage} />

        <!-- RSS -->
        <link
            rel="alternate"
            type="application/rss+xml"
            title="Highcoo Blog"
            href="/rss.xml"
        />

        <link rel="icon" type="image/png" href="/images/logo.png" />

        <!-- Fonts: Libre Baskerville (headlines) + DM Sans (body) -->
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&family=DM+Sans:ital,opsz,wght@0,9..40,400;0,9..40,500;0,9..40,600;1,9..40,400&display=swap"
            rel="stylesheet"
        />

        <title>{pageTitle}</title>
    </head>
    <body>
        <header class="site-header">
            <div class="container">
                <nav class="nav" aria-label="Main navigation">
                    <a href="/" class="logo" aria-label="Highcoo — home">
                        <img
                            src="/images/logo.png"
                            alt=""
                            width="40"
                            height="40"
                            aria-hidden="true"
                        />
                        <span class="logo-text">highcoo</span>
                    </a>

                    <button
                        class="nav-toggle"
                        aria-controls="nav-menu"
                        aria-expanded="false"
                        aria-label="Toggle menu"
                    >
                        <span class="nav-toggle-bar"></span>
                        <span class="nav-toggle-bar"></span>
                        <span class="nav-toggle-bar"></span>
                    </button>

                    <ul class="nav-links" id="nav-menu" role="list">
                        <li><a href="/blog">Blog</a></li>
                        <li>
                            <a href="https://pasture.highcoo.studio">Demo</a>
                        </li>
                        <li>
                            <a
                                href="https://github.com/CordlessWool/highcoo"
                                class="btn btn--secondary btn--sm"
                            >
                                <svg
                                    width="15"
                                    height="15"
                                    viewBox="0 0 24 24"
                                    fill="currentColor"
                                    aria-hidden="true"
                                >
                                    <path
                                        d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0024 12c0-6.63-5.37-12-12-12z"
                                    ></path>
                                </svg>
                                GitHub
                            </a>
                        </li>
                    </ul>
                </nav>
            </div>
        </header>

        <main>
            <slot />
        </main>

        <footer class="site-footer">
            <div class="container">
                <div class="footer-inner">
                    <div class="footer-brand">
                        <img
                            src="/images/logo.png"
                            alt=""
                            width="22"
                            height="22"
                            aria-hidden="true"
                        />
                        <span class="footer-wordmark">highcoo</span>
                    </div>
                    <p class="footer-copy">
                        Open source photo management. &copy; {
                            new Date().getFullYear()
                        }
                    </p>
                    <ul class="footer-links" role="list">
                        <li>
                            <a href="https://github.com/CordlessWool/highcoo"
                                >GitHub</a
                            >
                        </li>
                        <li>
                            <a href="/blog/getting-started-with-highcoo"
                                >Setup Guide</a
                            >
                        </li>
                        <li><a href="/blog">Blog</a></li>
                        <li><a href="/rss.xml">RSS</a></li>
                    </ul>
                </div>
            </div>
        </footer>

        <script>
            const toggle =
                document.querySelector<HTMLButtonElement>(".nav-toggle");
            const menu = document.querySelector<HTMLUListElement>("#nav-menu");
            if (toggle && menu) {
                toggle.addEventListener("click", () => {
                    const expanded =
                        toggle.getAttribute("aria-expanded") === "true";
                    toggle.setAttribute("aria-expanded", String(!expanded));
                    menu.classList.toggle("nav-links--open");
                });
            }
        </script>
    </body>
</html>

<style is:global>
    @import "../styles/global.css";
</style>

<style>
    /* ── Header ──────────────────────────────────────── */
    .site-header {
        position: sticky;
        top: 0;
        z-index: 100;
        background: color-mix(in srgb, var(--color-bg) 88%, transparent);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        border-bottom: 1px solid var(--color-border-subtle);
    }

    .nav {
        display: flex;
        align-items: center;
        justify-content: space-between;
        height: 60px;
        gap: var(--space-lg);
    }

    /* ── Logo ────────────────────────────────────────── */
    .logo {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        text-decoration: none;
        flex-shrink: 0;
    }

    .logo img {
        width: 77px;
        object-fit: contain;
    }

    .logo-text {
        font-family: var(--font-display);
        font-size: 1.125rem;
        font-weight: 700;
        color: var(--color-text);
        letter-spacing: -0.02em;
        line-height: 1;
    }

    /* ── Nav links ───────────────────────────────────── */
    .nav-toggle {
        display: none;
        flex-direction: column;
        justify-content: center;
        gap: 5px;
        width: 36px;
        height: 36px;
        background: none;
        border: none;
        cursor: pointer;
        padding: 6px;
        border-radius: 6px;
        color: var(--color-text);
        flex-shrink: 0;
    }
    .nav-toggle:hover {
        background: var(--color-bg-alt);
    }

    .nav-toggle-bar {
        display: block;
        width: 20px;
        height: 1.5px;
        background: currentColor;
        border-radius: 2px;
        transition:
            transform 0.2s ease,
            opacity 0.2s ease;
    }
    .nav-toggle[aria-expanded="true"] .nav-toggle-bar:nth-child(1) {
        transform: translateY(6.5px) rotate(45deg);
    }
    .nav-toggle[aria-expanded="true"] .nav-toggle-bar:nth-child(2) {
        opacity: 0;
    }
    .nav-toggle[aria-expanded="true"] .nav-toggle-bar:nth-child(3) {
        transform: translateY(-6.5px) rotate(-45deg);
    }

    .nav-links {
        display: flex;
        align-items: center;
        gap: 0.25rem;
        list-style: none;
    }

    .nav-links a {
        display: block;
        padding: 0.375rem 0.75rem;
        text-decoration: none;
        color: var(--color-text-muted);
        font-size: 0.9rem;
        font-weight: 500;
        border-radius: 6px;
        transition:
            color 0.12s,
            background 0.12s;
    }
    .nav-links a:hover {
        color: var(--color-text);
        background: var(--color-bg-alt);
    }

    .nav-links a[aria-current="page"] {
        color: var(--color-text);
    }

    .btn--sm {
        padding: 0.375rem 0.875rem;
        font-size: 0.875rem;
    }

    /* ── Footer ──────────────────────────────────────── */
    .site-footer {
        padding: var(--space-xl) 0 var(--space-lg);
        border-top: 1px solid var(--color-border-subtle);
        margin-top: var(--space-2xl);
    }

    .footer-inner {
        display: flex;
        align-items: center;
        gap: var(--space-lg);
        flex-wrap: wrap;
    }

    .footer-brand {
        display: flex;
        align-items: center;
        gap: 0.4rem;
        margin-right: auto;
    }

    .footer-brand img {
        width: 22px;
        height: 22px;
        object-fit: contain;
        opacity: 0.6;
    }

    .footer-wordmark {
        font-family: var(--font-display);
        font-size: 1rem;
        font-weight: 400;
        color: var(--color-text-muted);
        letter-spacing: -0.025em;
    }

    .footer-copy {
        color: var(--color-text-muted);
        font-size: 0.85rem;
        max-width: none;
    }

    .footer-links {
        display: flex;
        gap: 0.25rem;
        list-style: none;
    }

    .footer-links a {
        color: var(--color-text-muted);
        font-size: 0.85rem;
        text-decoration: none;
        padding: 0.25rem 0.5rem;
        border-radius: 4px;
        transition: color 0.12s;
    }
    .footer-links a:hover {
        color: var(--color-text);
    }

    /* ── Mobile nav ──────────────────────────────────── */
    @media (max-width: 640px) {
        .nav-toggle {
            display: flex;
        }

        .nav-links {
            display: none;
            position: absolute;
            top: 61px;
            left: 0;
            right: 0;
            background: var(--color-bg);
            border-bottom: 1px solid var(--color-border);
            flex-direction: column;
            align-items: stretch;
            gap: 0;
            padding: 0.5rem;
        }

        .nav-links.nav-links--open {
            display: flex;
        }

        .nav-links a {
            padding: 0.75rem 1rem;
            border-radius: 6px;
        }

        .nav-links .btn--sm {
            border-radius: 6px;
            text-align: left;
        }

        .footer-inner {
            flex-direction: column;
            align-items: flex-start;
            gap: var(--space-md);
        }

        .footer-brand {
            margin-right: 0;
        }

        .footer-links {
            flex-wrap: wrap;
            gap: 0.25rem;
        }
    }
</style>
